# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    telnet.expect                                      :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: heleneherin <heleneherin@student.42.fr>    +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2021/04/28 13:04:49 by heleneherin       #+#    #+#              #
#    Updated: 2021/05/03 14:57:49 by heleneherin      ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

#!/usr/bin/expect -f

set timeout -1

set args [lrange $argv 0 end]

set fd [open "ls_files"]
set filepath [split [read -nonewline $fd] "\n"]
close $fd


foreach path $filepath {
    spawn telnet {*}$args
    expect ".\r"
    puts "$path"
    set fdreq [open "$path"]
    set request [read $fdreq]
    close $fdreq
    send -- "$request\r"  
    sleep 1
}
expect eof